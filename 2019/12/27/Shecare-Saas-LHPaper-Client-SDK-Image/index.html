<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="SDK简介 Shecare智能试纸识别SAAS SDK主要功能利用手机端的拍照功能对于目前市面上的排卵、早孕试纸进行自动拍照识别；该技术基于深度学习，在背景相对复杂的情况下识别宽松准确率可以达到90%，几乎接近人眼的识别水平；该SDK对于孕橙试纸识别宽松准确率超过95%，超过人眼的识别水平； 由于采用了深度学习技术，Shecare的试纸识别算法可以在半人工干预的情况下实现自我反馈、学习以及更新，随">
<meta property="og:type" content="article">
<meta property="og:title" content="孕橙智能试纸识别算法之客户端API说明">
<meta property="og:url" content="https://ikangtai.github.io/2019/12/27/Shecare-Saas-LHPaper-Client-SDK-Image/index.html">
<meta property="og:site_name" content="爱康泰文档发布平台">
<meta property="og:description" content="SDK简介 Shecare智能试纸识别SAAS SDK主要功能利用手机端的拍照功能对于目前市面上的排卵、早孕试纸进行自动拍照识别；该技术基于深度学习，在背景相对复杂的情况下识别宽松准确率可以达到90%，几乎接近人眼的识别水平；该SDK对于孕橙试纸识别宽松准确率超过95%，超过人眼的识别水平； 由于采用了深度学习技术，Shecare的试纸识别算法可以在半人工干预的情况下实现自我反馈、学习以及更新，随">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/app_download.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-12-27_1-59-27.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/20191216100235.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-12-27_2-8-35.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-12-27_2-17-18.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/call-flow-chart.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/movie-guide.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/modular-structure.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/dialog-box-description.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-11-26_22-34-45.png">
<meta property="og:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-11-29_12-4-23.png">
<meta property="og:updated_time" content="2020-04-07T10:42:31.103Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="孕橙智能试纸识别算法之客户端API说明">
<meta name="twitter:description" content="SDK简介 Shecare智能试纸识别SAAS SDK主要功能利用手机端的拍照功能对于目前市面上的排卵、早孕试纸进行自动拍照识别；该技术基于深度学习，在背景相对复杂的情况下识别宽松准确率可以达到90%，几乎接近人眼的识别水平；该SDK对于孕橙试纸识别宽松准确率超过95%，超过人眼的识别水平； 由于采用了深度学习技术，Shecare的试纸识别算法可以在半人工干预的情况下实现自我反馈、学习以及更新，随">
<meta name="twitter:image" content="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/app_download.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://ikangtai.github.io/2019/12/27/Shecare-Saas-LHPaper-Client-SDK-Image/"/>





  <title>孕橙智能试纸识别算法之客户端API说明 | 爱康泰文档发布平台</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">爱康泰文档发布平台</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://ikangtai.github.io/2019/12/27/Shecare-Saas-LHPaper-Client-SDK-Image/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="iKangtai">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="爱康泰文档发布平台">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">孕橙智能试纸识别算法之客户端API说明</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-27T10:37:45+08:00">
                2019-12-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="SDK简介"><a href="#SDK简介" class="headerlink" title="SDK简介"></a>SDK简介</h1><ul>
<li>Shecare智能试纸识别SAAS SDK主要功能利用手机端的拍照功能对于目前市面上的排卵、早孕试纸进行自动拍照识别；该技术基于深度学习，在背景相对复杂的情况下识别宽松准确率可以达到90%，几乎接近人眼的识别水平；该SDK对于<a href="https://detail.tmall.com/item.htm?spm=a1z10.3-b.w4011-14891093812.63.412c355fbwZnyD&amp;id=594080767737&amp;rn=912e98ba7b4655e896fb3d88607a5e24&amp;abbucket=18&amp;skuId=4106371793195" target="_blank" rel="noopener">孕橙试纸</a>识别宽松准确率超过95%，超过人眼的识别水平；</li>
<li>由于采用了深度学习技术，Shecare的试纸识别算法可以在半人工干预的情况下实现自我反馈、学习以及更新，随着学习样本库的增加，Shecare 智能试纸识别SAAS SDK识别的准确率会越来越高；</li>
<li>另外为了增强用户体验，Shecare 智能试纸识别SAAS SDK对于iOS和Android端采取native的集成方式，为了让集成快速落地，我们的API设计遵循接口简单化、高度配置化原则；</li>
<li><p>Shecare 智能试纸识别SAAS SDK目前支持市面上所有的条形、笔形以及卡型等排卵、早孕试纸；</p>
<p>  <em>宽松准确率</em><br>  所谓的宽松准确率，指的是：</p>
<pre><code>a.试纸的阴性和阳性的判断不能错误；
b.在满足条件1的前提下，读值相差一个档位不算错误；
</code></pre><a id="more"></a> 
</li>
<li><p>孕橙APP的排卵试纸和早孕试纸模块同样调用了该SDK，如果想快速了解该SDK，可以扫描下方的二维码下载APP进行最终的用户体验；</p>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/app_download.png" alt=""></p>
</li>
</ul>
<h1 id="SDK更新日志"><a href="#SDK更新日志" class="headerlink" title="SDK更新日志"></a>SDK更新日志</h1><h2 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h2><table>
<thead>
<tr>
<th>更新时间</th>
<th>版本</th>
<th>更新内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-12-27</td>
<td>1.0</td>
<td>初始版本</td>
</tr>
</tbody>
</table>
<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><table>
<thead>
<tr>
<th>更新时间</th>
<th>版本</th>
<th>更新内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-12-27</td>
<td>1.0</td>
<td>初始版本</td>
</tr>
<tr>
<td>2020-03-02</td>
<td>1.5.2</td>
<td>添加试纸单周期分析<br>添加停止试纸分析网络请求</td>
</tr>
<tr>
<td>2020-04-02</td>
<td>1.5.3</td>
<td>优化sdk识别速度<br>添加判断手机性能是否满足sdk要求</td>
</tr>
</tbody>
</table>
<h1 id="支持平台"><a href="#支持平台" class="headerlink" title="支持平台"></a>支持平台</h1><p>目前孕橙智能试纸识别算法SDK支持以下平台：</p>
<ul>
<li><p>iOS</p>
</li>
<li><p>Android</p>
</li>
</ul>
<h1 id="体验DEMO安装"><a href="#体验DEMO安装" class="headerlink" title="体验DEMO安装"></a>体验DEMO安装</h1><p>为了让开发者快速上手，孕橙智能试纸识别算法SDK提供了体验Demo，并且该Demo提供完整的源码下载；详细的源码下载链接见下面的<a href="http://wiki.ikangtai.cn:8080/pages/viewpage.action?pageId=30475992#id-孕橙智能试纸识别算法之客户端API说明-SDK代码说明" target="_blank" rel="noopener">SDK代码说明</a>；</p>
<h2 id="iOS安装"><a href="#iOS安装" class="headerlink" title="iOS安装"></a>iOS安装</h2><h3 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h3><p><a href="https://fir.im/wmfg" target="_blank" rel="noopener">iOS fir.im</a></p>
<h2 id="Android安装"><a href="#Android安装" class="headerlink" title="Android安装"></a>Android安装</h2><h3 id="下载地址-1"><a href="#下载地址-1" class="headerlink" title="下载地址"></a>下载地址</h3><p><a href="https://fir.im/knu1" target="_blank" rel="noopener">Android fir.im</a></p>
<h2 id="测试图片下载"><a href="#测试图片下载" class="headerlink" title="测试图片下载"></a>测试图片下载</h2><p>为了快速体验Demo，可以下载下面的试纸，然后使用“图片选择“模式去体验我们的Demo：</p>
<ul>
<li><a href="https://yunchengfile.oss-cn-beijing.aliyuncs.com/others/shecare_45.jpeg" target="_blank" rel="noopener">https://yunchengfile.oss-cn-beijing.aliyuncs.com/others/shecare_45.jpeg</a></li>
<li><a href="https://yunchengfile.oss-cn-beijing.aliyuncs.com/others/shecare_0.jpeg" target="_blank" rel="noopener">https://yunchengfile.oss-cn-beijing.aliyuncs.com/others/shecare_0.jpeg</a></li>
</ul>
<h2 id="三种识别模式"><a href="#三种识别模式" class="headerlink" title="三种识别模式"></a>三种识别模式</h2><p>目前SDK Demo支持三种模式，即“智能扫描”模式、“手动裁剪”模式以及“选择图片”模式，每一种模式都有不同的应用场景；</p>
<h2 id="智能扫描模式"><a href="#智能扫描模式" class="headerlink" title="智能扫描模式"></a>智能扫描模式</h2><p>所谓抠图模式，整个体验过程类似于二维码的“扫一扫”，具体的示例Demo的UI如下图，该模式有以下几点特性：</p>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-12-27_1-59-27.png" alt=""></p>
<ol>
<li>对于市面上所有的条形试纸均有效，但是对于非条形（如笔形、卡型等）试纸无效；</li>
<li>自动扫描、抠图以及自动出结果；</li>
<li>该模式需要用户主动点击“拍照”按钮；</li>
<li>注意该模式下需要把整条试纸放入“取景框”内；</li>
<li>一旦识别出结果，我们的API会弹出试纸“抠图确认”页面，在该页面我们的Demo可以指示出T线、C线位置，并且如果T、C线的位置如果错误，用户可以手动拖动T、C线进行修改；</li>
<li>打开拍照开关，会有“惊喜”；</li>
</ol>
<h2 id="手动裁剪模式"><a href="#手动裁剪模式" class="headerlink" title="手动裁剪模式"></a>手动裁剪模式</h2><p>所谓裁剪模式，即需要用户把试纸的T、C线放入取景框中示意的裁剪框“中央”，并且尽量保证T、C线与水平线“竖直”，具体的示例Demo的UI如下图：</p>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/20191216100235.png" alt=""></p>
<ol>
<li>模式是解决非条形（如笔形、卡型等）试纸的“杀手锏”；</li>
<li>该模式对于条形试纸同样有效；</li>
<li>该模式需要用户手动点击“拍照”按钮；</li>
<li>一旦识别出结果，我们的API会弹出试纸“抠图确认”页面，在该页面我们的Demo可以指示出T线、C线位置，并且如果T、C线的位置如果错误，用户可以手动拖动T、C线进行修改；</li>
<li>该模式需要引导用户T线位于C线的左边；</li>
</ol>
<h2 id="选择图片模式"><a href="#选择图片模式" class="headerlink" title="选择图片模式"></a>选择图片模式</h2><p>所谓“选择图片模式”，即对于用户已经拍照的、并且放入图片库的试纸进行识别，点击下图红色字体的指示按钮即可体验：</p>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-12-27_2-8-35.png" alt=""></p>
<ol>
<li>在该模式下，一旦选择的图片被识别，我们的API会弹出试纸“抠图确认”页面，在该页面我们的Demo可以指示出T线、C线位置，并且如果T、C线的位置如果错误，用户可以手动拖动T、C线进行修改；</li>
<li>如果这种模式下找不到试纸，我们的API可以弹出“裁剪图片”功能，让用户通过拖动、旋转、移动以及缩放把试纸区域拖动到裁剪区域，我们的APP基于此进行识别；</li>
</ol>
<h2 id="试纸识别结果确认框"><a href="#试纸识别结果确认框" class="headerlink" title="试纸识别结果确认框"></a>试纸识别结果确认框</h2><p>在所有的模式下，只要API识别出试纸，我们的API都会弹出试纸识别确认框，如下图：</p>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-12-27_2-17-18.png" alt=""></p>
<ol>
<li>该确认框会指示出T、C线的位置；</li>
<li>用户如果认为T、C线不正确，可以拖动这2条线；</li>
<li>如果试纸左右识别颠倒，用户可以点击“水平翻转”进行翻转修改；</li>
<li>如果用户对于试纸识别结果不满意，可以点击“返回”按钮返回；</li>
</ol>
<h1 id="调用流程"><a href="#调用流程" class="headerlink" title="调用流程"></a>调用流程</h1><p>我们的API，整体来说有两个接口：</p>
<ol>
<li>一个接口的输入是视频流，然后对于视频流中的图片进行逐帧分析，然后给出结果，我们的“抠图模式”就是调用的这个API；</li>
<li>另外一个接口输入是图片，然后我们的API对于该图片进行分析，我们的“裁剪模式”、“选择图片模式”就是调用的这个API；</li>
</ol>
<h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><h4 id="输入参数是图片的API流程"><a href="#输入参数是图片的API流程" class="headerlink" title="输入参数是图片的API流程"></a>输入参数是图片的API流程</h4><p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/call-flow-chart.png" alt=""></p>
<h5 id="流程描述"><a href="#流程描述" class="headerlink" title="流程描述"></a>流程描述</h5><ol>
<li>调用方输入一张图片给SDK；</li>
<li>SDK判断图片中是否有试纸图片，如果无则返回错误；</li>
<li>如果有，则弹出<strong>试纸识别结果确认框</strong>；</li>
<li>在该弹出对话框上，用户可以根据识别结果进行T、C线拖动调整，翻转调整；</li>
<li>如果用户在页面点击了“返回”按钮，则试纸结果确认对话框消失，调用重新进行下一张图片的识别；</li>
<li>如果用户在页面点击了“确认”按钮，则试纸结果确认对话框消失，调用方获取返回的试纸T、C线位置，抠出的图片内容以及LH Level等；</li>
</ol>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">几点约定：</span><br><span class="line"></span><br><span class="line"><span class="code">	1.对于输入的图片，我们要求必须是正方形，对于传入的长方形的图片，偶尔可能成功，但是不建议使用；</span></span><br><span class="line"><span class="code">	2.返回的T、C线为算法经过算法计算一个均值线；</span></span><br><span class="line"><span class="code">	3.虽然目前试纸API返回了试纸T、C线的4条边界“直线”，但是这4条“直线”边界本身可能不是一个严格的边界，有些看起来是白色区域，但是可能被包含在T、C线区域内，具体原因如下：</span></span><br><span class="line"><span class="code">		a.试纸的T、C边界本身就不是一个boundry clear的边界；</span></span><br><span class="line"><span class="code">		b.有时候肉眼无法看出的细微的“红色”，但是在计算机图形学里面可能就是一个色值，然后从T、C线的角度来说，可能会被计算在内；</span></span><br></pre></td></tr></table></figure>
<h4 id="输入参数是视频流的API流程图"><a href="#输入参数是视频流的API流程图" class="headerlink" title="输入参数是视频流的API流程图"></a>输入参数是视频流的API流程图</h4><p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/movie-guide.png" alt=""></p>
<h5 id="流程描述-1"><a href="#流程描述-1" class="headerlink" title="流程描述"></a>流程描述</h5><ol>
<li>调用方输入视频流给SDK；</li>
<li>SDK对于视频流进行解析成一帧帧图片；</li>
<li>选取其中的一帧图片，判断图片中是否有试纸图片，如果无则继续分析下一帧图片；</li>
<li>如果有，则弹出<strong>试纸识别结果确认框</strong>；</li>
<li>在该弹出对话框上，用户可以根据识别结果进行T、C线拖动调整，翻转调整；</li>
<li>如果用户在页面点击了“返回”按钮，则试纸结果确认对话框消失，调用重新进行下一张图片的识别；</li>
<li>如果用户在页面点击了“确认”按钮，则试纸结果确认对话框消失，调用方获取返回的试纸T、C线位置，抠出的图片内容以及LH Level等；</li>
</ol>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">几点约定：</span><br><span class="line"><span class="code">	1.返回的T、C线为算法经过算法计算一个均值线；</span></span><br><span class="line"><span class="code">	2.虽然目前试纸API返回了试纸T、C线的4条边界“直线”，但是这4条“直线”边界本身可能不是一个严格的边界，有些看起来是白色区域，但是可能被包含在T、C线区域内，具体原因如下：</span></span><br><span class="line"><span class="code">		a.试纸的T、C边界本身就不是一个boundry clear的边界；</span></span><br><span class="line"><span class="code">		b.有时候肉眼无法看出的细微的“红色”，但是在计算机图形学里面可能就是一个色值，然后从T、C线的角度来说，可能会被计算在内；</span></span><br></pre></td></tr></table></figure>
<h1 id="模块结构图"><a href="#模块结构图" class="headerlink" title="模块结构图"></a>模块结构图</h1><p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/modular-structure.png" alt=""></p>
<h2 id="模块描述"><a href="#模块描述" class="headerlink" title="模块描述"></a>模块描述</h2><p>我们的试纸识别技术基于深度学习框架，共分为三个模块：</p>
<ul>
<li>试纸识别API；</li>
<li>错误反馈机制；</li>
<li>Shecare Cloud模块；</li>
</ul>
<h3 id="试纸识别API"><a href="#试纸识别API" class="headerlink" title="试纸识别API"></a>试纸识别API</h3><p>整个识别过程共分为二个阶段，即一阶段的抠图（从图片或者视频流中抠出试纸条）以及二阶段的颜色识别；目前一阶段在本地实现，而二阶段是在云端实现，阶段二依赖于阶段一：也即是如果阶段一不成功，则不会进行阶段二；由于仅仅阶段二涉及到网络传输，并且这个仅仅传输抠出的非常小的试纸条，所以一次成功的识别网络传输的代价非常小；</p>
<h3 id="错误反馈机制"><a href="#错误反馈机制" class="headerlink" title="错误反馈机制"></a><strong>错误反馈机制</strong></h3><p>由于我们的试纸识别技术基于深度学习，所以我们会对于一些错误的case进行搜集，譬如在试纸确认页面，如果用户拖动了T、C线；再譬如在试纸确认页面用户选择了返回等，这些反馈对于我们算法的优化提供数据支撑；</p>
<h3 id="Shecare-Cloud模块"><a href="#Shecare-Cloud模块" class="headerlink" title="Shecare Cloud模块"></a>Shecare Cloud模块</h3><p>该模块对于T、C线的值进行识别，并且对于用户输入的反馈进行处理，基于深度学习技术半自动化的优化我们的算法；</p>
<h1 id="定制试纸识别结果确认框"><a href="#定制试纸识别结果确认框" class="headerlink" title="定制试纸识别结果确认框"></a>定制试纸识别结果确认框</h1><h2 id="对话框说明"><a href="#对话框说明" class="headerlink" title="对话框说明"></a>对话框说明</h2><ul>
<li>一旦智能试纸识别API从图片中识别出试纸，则弹出定制的试纸识别结果确认框（如下图），该确认框有如下作用：</li>
</ul>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/dialog-box-description.png" alt=""></p>
<ul>
<li>试纸识别结果识别是一件从“医疗级”来说非常严肃的事情，所以经过用户的double confirm是必要的；</li>
<li>如果用户发现C、T线识别的位置不对，可以手动拖动进行修改，给试纸的结果识别带来一个潜在的“补救”机会；</li>
<li>如果用户发现识别出试纸“左右颠倒”，可以手动拖动进行修改，给试纸的结果识别带来一个潜在的“补救”机会；</li>
<li>调用方不需要处理确认页的“拖动”以及“点击”事件，更专注于自己的“业务逻辑”；</li>
<li>由于该确认框由SDK弹出，所以为了保证该弹出框能够适配调用方不同UI风格，该确认框高度灵活配置；</li>
</ul>
<h2 id="相关配置项"><a href="#相关配置项" class="headerlink" title="相关配置项"></a>相关配置项</h2><p>如下图，定制项如下：</p>
<ul>
<li>确认界面的语言以及对应的描述；</li>
<li>“确认”以及“返回”按钮的颜色以及图片；</li>
<li>抠出图片宽度外延的像素点；</li>
</ul>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-11-26_22-34-45.png" alt=""></p>
<h1 id="试纸识别值的映射"><a href="#试纸识别值的映射" class="headerlink" title="试纸识别值的映射"></a>试纸识别值的映射</h1><p>目前Shecare智能试纸识别SAAS SDK对于排卵试纸的值返回共有8个值：0、5、10、15、20、25、45、65，在这8个值中：</p>
<ul>
<li>0代表无；</li>
<li>25属于阴阳的分界，并且25属于阳；</li>
<li>65最高值，属于强阳；</li>
<li>其他的值由调用者根据自己的业务进行灵活的映射和配置；</li>
</ul>
<h1 id="SDK代码说明"><a href="#SDK代码说明" class="headerlink" title="SDK代码说明"></a>SDK代码说明</h1><h2 id="iOS-1"><a href="#iOS-1" class="headerlink" title="iOS"></a>iOS</h2><h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><p>Demo 地址：<a href="https://e.coding.net/yuncheng/SCPaperAnalysiserSDKDemo-iOS.git" target="_blank" rel="noopener">https://e.coding.net/yuncheng/SCPaperAnalysiserSDKDemo-iOS.git</a> （SDK 在 Demo 里）</p>
<h3 id="函数说明"><a href="#函数说明" class="headerlink" title="函数说明"></a>函数说明</h3><h4 id="SDK-Config"><a href="#SDK-Config" class="headerlink" title="SDK Config"></a>SDK Config</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">/** 设置 SDK 环境。默认是测试环境 YCSEnvironmentDebug */</span><br><span class="line">@property (assign, nonatomic) YCSEnvironment environment;</span><br><span class="line">/** 应用授权相关的 appID */</span><br><span class="line">@property (nonatomic, copy) NSString *appID;</span><br><span class="line">/** 应用授权相关的 appSecret */</span><br><span class="line">@property (nonatomic, copy) NSString *appSecret;</span><br><span class="line">/** 固定值，不需要设置 */</span><br><span class="line">@property (nonatomic, copy) NSString *sessionId;</span><br><span class="line">/** 用户身份标识符，全局唯一且同一个用户固定不变 */</span><br><span class="line">@property (nonatomic, copy) NSString *userID;</span><br><span class="line">/** 结果确认页 UI 主色调 */</span><br><span class="line">@property (nonatomic, strong) UIColor *mainColor;</span><br><span class="line">/** 结果确认页 字体 主色调 */</span><br><span class="line">@property (nonatomic, strong) UIColor *textColor;</span><br><span class="line">/** 结果确认页 “取消” 按钮图片 */</span><br><span class="line">@property (nonatomic, strong) UIImage *cancelImg;</span><br><span class="line">/** 结果确认页 “确认” 按钮图片 */</span><br><span class="line">@property (nonatomic, strong) UIImage *confirmImg;</span><br><span class="line">/** 结果确认页 T 滑块图片 */</span><br><span class="line">@property (nonatomic, strong) UIImage *tImage;</span><br><span class="line">/** 结果确认页 C 滑块图片 */</span><br><span class="line">@property (nonatomic, strong) UIImage *cImage;</span><br><span class="line">/** 结果确认页 标题 */</span><br><span class="line">@property (nonatomic, copy) NSString *title;</span><br><span class="line">/** 结果确认页 “翻转” 按钮标题 */</span><br><span class="line">@property (nonatomic, copy) NSString *flipTitle;</span><br><span class="line">/** 结果确认页 说明 */</span><br><span class="line">@property (nonatomic, copy) NSString *comment;</span><br><span class="line">/** 算法返回的图片是否需要 “外扩”，默认否 */</span><br><span class="line">@property (nonatomic, assign, getter=isExtended) ``BOOL` `extended;</span><br><span class="line">/** “外扩” 的像素（仅在 extended=true 时有效） */</span><br><span class="line">@property (nonatomic, assign) NSInteger pixelOfExtended;</span><br><span class="line">/** 扫描超时时长。默认为 15s，最少为 1s（仅在视频流扫描模式下有效） */</span><br><span class="line">@property (nonatomic, assign) CFTimeInterval timeIntervalOfScan;</span><br><span class="line">/** “连续成功” 的最少次数，默认为 5 次。为保证扫描结果准确性，建议采用 “连续多次扫描成功才认为整个流程成功” 的判定方法。（仅在视频流扫描模式下有效） */</span><br><span class="line">@property (nonatomic, assign) NSUInteger numberOfSuccess;</span><br><span class="line">/** 相同错误码连续出现的次数，默认为 3 次。算法可能在短时间内返回很多错误码，为保证用户体验，建议设置此值。用于控制 “相同错误码连续出现若干次，才在 UI 上提示用户” （仅在视频流扫描模式下有效） */</span><br><span class="line">@property (nonatomic, assign) NSUInteger numberOfErrors;</span><br><span class="line">/** 0未知；1 相册；2 拍照 */</span><br><span class="line">@property (nonatomic, assign) SCImageType source;</span><br></pre></td></tr></table></figure>
<h4 id="主函数调用"><a href="#主函数调用" class="headerlink" title="主函数调用"></a>主函数调用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/*! @brief 获取一张图片的扫描和分析结果</span><br><span class="line">* @param image 用于扫描的试纸照片</span><br><span class="line">* @param completion 完成回调，用于返回扫描和分析的结果</span><br><span class="line">*/</span><br><span class="line">-(``void``)getScanResultFromImage:(UIImage *)image completion:(``void` `(^)(SCPaperAnalysiserResult *result))completion;</span><br><span class="line">/*! @brief 结束扫描和分析流程</span><br><span class="line">*/</span><br><span class="line">-(``void``)closeSession:(SCPaperAnalysiserResult * _Nullable)result;</span><br></pre></td></tr></table></figure>
<h4 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/** 最终返回的抠图结果 */</span><br><span class="line">@property (nonatomic, strong, readonly) UIImage *finalImage;</span><br><span class="line">/** 算法返回的 四边形 坐标点 */</span><br><span class="line">@property (nonatomic, strong, nullable) NSArray *maskPoints;</span><br><span class="line">/** 算法返回的 错误码 */</span><br><span class="line">@property (nonatomic, assign) SCErrorCode errorCode;</span><br><span class="line">/** 算法返回的 模糊度 */</span><br><span class="line">@property (nonatomic, assign) CGFloat blurExtent;</span><br><span class="line">/** 算法返回的 C 线位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat cPosition;</span><br><span class="line">/** 算法返回的 T 线位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat tPosition;</span><br><span class="line">/** 算法返回的 T 线区域左边缘位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat lhTlineLeft;</span><br><span class="line">/** 算法返回的 T 线区域右边缘位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat lhTlineRight;</span><br><span class="line">/** 算法返回的 C 线区域左边缘位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat lhClineLeft;</span><br><span class="line">/** 算法返回的 C 线区域右边缘位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat lhClineRight;</span><br><span class="line">/** 用户确认的 C 线位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat newCPosition;</span><br><span class="line">/** 用户确认的 T 线位置 */</span><br><span class="line">@property (nonatomic, assign) CGFloat newTPosition;</span><br><span class="line">/** 是否翻转 */</span><br><span class="line">@property (nonatomic, assign) ``BOOL` `flipped;</span><br><span class="line">/** 算法返回的试纸分析结果 */</span><br><span class="line">@property (nonatomic, assign) NSInteger lhResult;</span><br><span class="line">/** 用户确认的试纸结果 */</span><br><span class="line">@property (nonatomic, assign) NSInteger newLHResult;</span><br><span class="line">/** 算法返回的 Ratio 值 */</span><br><span class="line">@property (nonatomic, assign) CGFloat lhRatio;</span><br><span class="line">/** 算法返回的试纸类型 */</span><br><span class="line">@property (nonatomic, assign) SCPaperType paperType;</span><br><span class="line">/** 试纸测试时间 */</span><br><span class="line">@property (nonatomic, strong) NSDate *lhTime;</span><br><span class="line">/** 试纸图片来源：1 相册；2 拍照 */</span><br><span class="line">@property (nonatomic, assign) SCImageType source;</span><br></pre></td></tr></table></figure>
<h4 id="错误描述"><a href="#错误描述" class="headerlink" title="错误描述"></a>错误描述</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">/// 试纸抠图、分析错误码</span><br><span class="line">typedef NS_ENUM(NSInteger, SCErrorCode) &#123;</span><br><span class="line">     </span><br><span class="line">    /// 抠图成功、分析成功，流程内没有错误产生；</span><br><span class="line">    SCErrorCodeNoError = 0,</span><br><span class="line">     </span><br><span class="line">    /// SDK 校验失败或无效</span><br><span class="line">    SCErrorCodeSDKError = -2,</span><br><span class="line">    /// 未知错误（默认值）；</span><br><span class="line">    SCErrorCodeUnknownError = -1,</span><br><span class="line">     </span><br><span class="line">    /* 阶段 1 中间过程错误码（或单张照片扫描结果的错误码） */</span><br><span class="line">    /// 没有找到试纸；</span><br><span class="line">    SCErrorCodeNoPaper = 1,</span><br><span class="line">    /// 距离过远；</span><br><span class="line">    SCErrorCodeTooFar = 2,</span><br><span class="line">    /// 背景过脏；</span><br><span class="line">    SCErrorCodeTooDirty = 3,</span><br><span class="line">    /// 距离过近；</span><br><span class="line">    SCErrorCodeTooClose = 4,</span><br><span class="line">    /// 试纸不全；</span><br><span class="line">    SCErrorCodeNotCompleted = 5,</span><br><span class="line">    /// 神经网络加载错误；</span><br><span class="line">    SCErrorCodeHedNetError = 6,</span><br><span class="line">    /// 背景内不止一张试纸；</span><br><span class="line">    SCErrorCodeTooManyPapers = 7,</span><br><span class="line">    /// 曝光不足；</span><br><span class="line">    SCErrorCodeUnderExposure = 8,</span><br><span class="line">    /// 曝光过度；</span><br><span class="line">    SCErrorCodeExposed = 9,</span><br><span class="line">    /// 试纸局部曝光过度；</span><br><span class="line">    SCErrorCodePartlyExposed = 10,</span><br><span class="line">    /// 画面模糊；</span><br><span class="line">    SCErrorCodeBlurred = 11,</span><br><span class="line">    /// 曝光不足（OpenCV 二次确认）；</span><br><span class="line">    SCErrorCodeUnderExposure2 = 12,</span><br><span class="line">     </span><br><span class="line">    /* 阶段 1 结束错误码 */</span><br><span class="line">    /// 抠图失败，视频流扫描超时</span><br><span class="line">    SCErrorCodeVideoOutofDate = 17,</span><br><span class="line">     </span><br><span class="line">    /* 阶段 2 错误码 */</span><br><span class="line">    /// 抠图成功，但是分析失败</span><br><span class="line">    SCErrorCodeGetValueError = 101,</span><br><span class="line">     </span><br><span class="line">    /* 阶段 3 错误码 */</span><br><span class="line">    /// 抠图成功，分析成功，但是用户取消确认抠图和分析结果</span><br><span class="line">    SCErrorCodeUserCanceled = 201,</span><br><span class="line">    /// 抠图成功，分析成功，但未检测到参考线，请确认试纸有参考线显示</span><br><span class="line">    SCErrorCodeNoCLine = 202,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="调用场景代码片段"><a href="#调用场景代码片段" class="headerlink" title="调用场景代码片段"></a>调用场景代码片段</h3><h4 id="“抠图模式”代码调用片段"><a href="#“抠图模式”代码调用片段" class="headerlink" title="“抠图模式”代码调用片段"></a>“抠图模式”代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// “视频抠图模式” 下，调用方需实现以下三个代理方法</span><br><span class="line">-(void)analysiser:(SCPaperAnalysiser *)analysiser didGetVideoResult:(SCPaperAnalysiserResult *)result bkImage:(UIImage *)bkImage &#123;</span><br><span class="line">    self.curOutputImage = bkImage;</span><br><span class="line">    // 根据 SDK 返回的 “试纸区域” 顶点坐标，绘制 “试纸区域” 到页面 UI</span><br><span class="line">    if (result.maskPoints.count == 0) &#123;</span><br><span class="line">        // 没有返回顶点坐标时，刷新页面</span><br><span class="line">        [self setupMaskLayer:[self nullPoints]];</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        [self addMaskLayerWithPoints:result.maskPoints onImage:bkImage];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-(void)analysiser:(SCPaperAnalysiser *)analysiser didFinishVideoScan:(SCPaperAnalysiserResult *)result &#123;</span><br><span class="line">    // SDK 回调，后续处理取决于业务需求，Demo 仅为示例</span><br><span class="line">    // SDK 成功返回抠图和分析结果</span><br><span class="line">    if (result.error.code == SCErrorCodeNoError) &#123;</span><br><span class="line">        NSLog(@&quot;Result: %@&quot;, result);</span><br><span class="line"> </span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            YCLHResultViewController *vc = [[YCLHResultViewController alloc] initWithResult:result];</span><br><span class="line">            [self.navigationController pushViewController:vc animated:YES];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else if (SCErrorCodeVideoOutofDate == result.error.code) &#123;</span><br><span class="line">        // 扫描超时，切换到手动裁剪模式</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            [self setupUIWithScanning:false];</span><br><span class="line">            self.switchBtn.selected = false;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        // 其他错误</span><br><span class="line">        [self analysiser:analysiser didGetVideoError:[self analysiser:analysiser messageWithError:result.error]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// SDK 返回错误信息时的处理</span><br><span class="line">-(void)analysiser:(SCPaperAnalysiser *)analysiser didGetVideoError:(NSString *)errInfo &#123;</span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        if (errInfo.length &gt; 0) &#123;</span><br><span class="line">            [self.errorLbl setTitle:errInfo forState:UIControlStateNormal];</span><br><span class="line">            self.errorLbl.alpha = 1.0f;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            self.errorLbl.alpha = 0.0f;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>`</p>
<h4 id="“裁剪模式”代码调用片段"><a href="#“裁剪模式”代码调用片段" class="headerlink" title="“裁剪模式”代码调用片段"></a>“裁剪模式”代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 调用方使用以下方法处理 “照片手动裁剪” 模式下的 SDK 调用</span><br><span class="line">// 传入的 image 是 “经过了用户拖动、缩放、旋转等操作后的当前页面截图”</span><br><span class="line">// points 是 “裁剪框” 的左上角和右下角顶点坐标</span><br><span class="line">[[SCPaperAnalysiser shared] getScanResultFromSnapShot:image points:points completion:^(SCPaperAnalysiserResult * _Nonnull result) &#123;</span><br><span class="line">    result.source = SCImageSourceAlbum;</span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        YCLHResultViewController *vc = [[YCLHResultViewController alloc] initWithResult:result];</span><br><span class="line">        [self.navigationController pushViewController:vc animated:YES];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;];</span><br><span class="line"> </span><br><span class="line">// 调用方使用以下方法处理 “视频手动裁剪” 模式下的 SDK 调用，类似 “照片手动裁剪” 模式</span><br><span class="line">// 传入的 image 是 “用户点击拍照时的那一帧”</span><br><span class="line">// points 是 “裁剪框” 的左上角和右下角顶点坐标</span><br><span class="line">[[SCPaperAnalysiser shared] getScanResultFromSnapShot:self.curOutputImage points:[self defaultPoints:self.curOutputImage] completion:^(SCPaperAnalysiserResult * _Nonnull result) &#123;</span><br><span class="line">    result.source = SCImageSourceCamera;</span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        YCLHResultViewController *vc = [[YCLHResultViewController alloc] initWithResult:result];</span><br><span class="line">        [self.navigationController pushViewController:vc animated:YES];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>`</p>
<h4 id="“图片选择模式”代码调用片段"><a href="#“图片选择模式”代码调用片段" class="headerlink" title="“图片选择模式”代码调用片段"></a>“图片选择模式”代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 调用方使用以下方法实现 “图片选择模式” 下的 SDK 方法调用</span><br><span class="line">SCPaperAnalysiserConfiguration.shared.source = SCImageSourceAlbum;</span><br><span class="line">YCWeakSelf(self)</span><br><span class="line">[[SCPaperAnalysiser shared] getScanResultFromImage:oriImage completion:^(SCPaperAnalysiserResult * _Nonnull result) &#123;</span><br><span class="line">    YCStrongSelf(self)</span><br><span class="line">    // SDK 回调，后续处理取决于业务需求，Demo 仅为示例</span><br><span class="line">    if (result.error.code == SCErrorCodeNoError || result.error.code == SCErrorCodeNoCLine) &#123;</span><br><span class="line">        NSLog(@&quot;Result: %@&quot;, result);</span><br><span class="line"> </span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            YCLHResultViewController *vc = [[YCLHResultViewController alloc] initWithResult:result];</span><br><span class="line">            [self.navigationController pushViewController:vc animated:YES];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;Error: %@&quot;, result.error);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>`</p>
<h4 id="“试纸结果识别确认框”样式代码调用片段"><a href="#“试纸结果识别确认框”样式代码调用片段" class="headerlink" title="“试纸结果识别确认框”样式代码调用片段"></a>“试纸结果识别确认框”样式代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// SDK 配置参数，详细说明见 SDK Config 或 framework 头文件</span><br><span class="line">SCPaperAnalysiserConfiguration *scConfig = [SCPaperAnalysiserConfiguration shared];</span><br><span class="line">scConfig.extended = true;</span><br><span class="line">scConfig.pixelOfExtended = 2;</span><br><span class="line">scConfig.cancelImg = [UIImage imageNamed:@&quot;test_paper_return&quot;];</span><br><span class="line">scConfig.confirmImg = [UIImage imageNamed:@&quot;test_paper_confirm&quot;];</span><br><span class="line">scConfig.title = @&quot;拍照结果&quot;;</span><br><span class="line">scConfig.flipTitle = @&quot;水平翻转&quot;;</span><br><span class="line">scConfig.comment = @&quot;请拖动TC线以确认TC线标注正确，水平翻转保证MAX箭头指向左边&quot;;</span><br><span class="line">scConfig.cImage = [UIImage imageNamed:@&quot;c_line_slices&quot;];</span><br><span class="line">scConfig.tImage = [UIImage imageNamed:@&quot;t_line_slices&quot;];</span><br><span class="line">scConfig.mainColor = [UIColor colorWithHex:0xFF7486];</span><br><span class="line">scConfig.textColor = [UIColor colorWithHex:0x444444];</span><br></pre></td></tr></table></figure>
<p>`</p>
<h3 id="如何debug"><a href="#如何debug" class="headerlink" title="如何debug"></a>如何debug</h3><p>SDK 的日志会和应用里的 NSLog（Swift 对应 print）输出到一起，分别以 Shecare(Debug)、Shecare(Info)、Shecare(Error) 开头表示不同的日志等级。需要 Debug 时，把 Shecare 开头的日志上传即可。</p>
<h2 id="Android-1"><a href="#Android-1" class="headerlink" title="Android"></a>Android</h2><h3 id="代码示例-1"><a href="#代码示例-1" class="headerlink" title="代码示例"></a>代码示例</h3><p>Demo 地址：<a href="https://e.coding.net/yuncheng/ScPaperAnalysiserDemo_Android.git" target="_blank" rel="noopener">https://e.coding.net/yuncheng/ScPaperAnalysiserDemo_Android.git</a> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">一.引入试纸sdk库</span><br><span class="line">api &apos;com.ikangtai.papersdk:ScPaperAnalysiserLib:1.5.3&apos;</span><br><span class="line"> </span><br><span class="line">二.添加依赖库地址</span><br><span class="line"> </span><br><span class="line">maven &#123; url &apos;https://dl.bintray.com/ikangtaijcenter123/ikangtai&apos; &#125;</span><br><span class="line"> </span><br><span class="line">三.使用方法</span><br><span class="line"> </span><br><span class="line"> 全局网络配置需要在初始化sdk之前</span><br><span class="line">      //使用测试网络</span><br><span class="line">      Config.setTestServer(true);</span><br><span class="line">      //网络超时时间</span><br><span class="line">      Config.setNetTimeOut(30);</span><br><span class="line">      //判断手机性能是否满足sdk要求</span><br><span class="line">      1.SupportDeviceUtil.isSupport(getContext(),AppConstant.appId, AppConstant.appSecret)#第一次校验不准</span><br><span class="line">      2.application初始化中调用SupportDeviceUtil.isSupport(getContext(),AppConstant.appId, AppConstant.appSecret)，实际判断处调用SupportDeviceUtil.isSupport(getContext())     </span><br><span class="line">  1.初始化</span><br><span class="line">     </span><br><span class="line">    //初始化sdk</span><br><span class="line">    paperAnalysiserClient = new PaperAnalysiserClient(getContext(), appId, appSecret, &quot;xyl1@qq.com&quot;);</span><br><span class="line"> </span><br><span class="line">  2.常规配置</span><br><span class="line">   </span><br><span class="line">    /**</span><br><span class="line">    * log默认路径/data/Android/pageName/files/Documents/log.txt,可以通过LogUtils.getLogFilePath()获取</span><br><span class="line">    * 自定义log文件有两种方式,设置一次即可</span><br><span class="line">    *   1.new Config.Builder().logWriter(logWriter).</span><br><span class="line">    *   2.new Config.Builder().logFilePath(logFilePath).</span><br><span class="line">    */</span><br><span class="line">    String logFilePath = new File(FileUtil.createRootPath(getContext()), &quot;log_test.txt&quot;).getAbsolutePath();</span><br><span class="line">    BufferedWriter logWriter = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        logWriter = new BufferedWriter(new FileWriter(logFilePath, true), 2048);</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    //试纸识别sdk相关配置</span><br><span class="line">    Config config = new Config.Builder().pixelOfdExtended(true).paperMinHeight(PxDxUtil.dip2px(getContext(), 20)).uiOption(uiOption).logWriter(logWriter).build();</span><br><span class="line">    paperAnalysiserClient = new PaperAnalysiserClient(getContext(), appId, appSecret, &quot;xyl1@qq.com&quot;,config);</span><br><span class="line">    或者</span><br><span class="line">    paperAnalysiserClient.init(config);</span><br><span class="line">  3.调用识别试纸图片</span><br><span class="line">    paperAnalysiserClient.analysisBitmap(fileBitmap, new IBitmapAnalysisEvent() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void showProgressDialog() &#123;</span><br><span class="line">                    //显示加载框</span><br><span class="line">                    LogUtils.d(&quot;Show Loading Dialog&quot;);</span><br><span class="line">					that.showProgressDialog(new View.OnClickListener() &#123;</span><br><span class="line"></span><br><span class="line">                            @Override</span><br><span class="line">                            public void onClick(View v) &#123;</span><br><span class="line">                                //停止网络请求</span><br><span class="line">                                paperAnalysiserClient.stopShowProgressDialog();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                @Override</span><br><span class="line">                public void dismissProgressDialog() &#123;</span><br><span class="line">                    //隐藏加载框</span><br><span class="line">                    LogUtils.d(&quot;Hide Loading Dialog&quot;);</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                @Override</span><br><span class="line">                public void cancel() &#123;</span><br><span class="line">                    LogUtils.d(&quot;取消试纸结果确认&quot;);</span><br><span class="line">                    //试纸结果确认框取消</span><br><span class="line">                    ToastUtils.show(getContext(), AiCode.getMessage(AiCode.CODE_201));</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                @Override</span><br><span class="line">                public void save(PaperResult paperResult) &#123;</span><br><span class="line">                    LogUtils.d(&quot;保存试纸分析结果：\n&quot;+paperResult.toString());</span><br><span class="line">                    //试纸结果确认框确认 显示试纸结果</span><br><span class="line">                    if (paperResult.getErrNo() != 0) &#123;</span><br><span class="line">                        ToastUtils.show(getContext(), AiCode.getMessage(paperResult.getErrNo()));</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                @Override</span><br><span class="line">                public boolean analysisSuccess(PaperCoordinatesData paperCoordinatesData, Bitmap originSquareBitmap, Bitmap clipPaperBitmap) &#123;</span><br><span class="line">                    LogUtils.d(&quot;试纸自动抠图成功&quot;);</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                @Override</span><br><span class="line">                public void analysisError(PaperCoordinatesData paperCoordinatesData, String errorResult, int code) &#123;</span><br><span class="line">                    LogUtils.d(&quot;试纸自动抠图出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">                    //试纸抠图失败结果</span><br><span class="line">                    ToastUtils.show(getContext(), AiCode.getMessage(code));</span><br><span class="line">                     </span><br><span class="line">                &#125;</span><br><span class="line"> </span><br><span class="line">                @Override</span><br><span class="line">                public void saasAnalysisError(String errorResult, int code) &#123;</span><br><span class="line">                    LogUtils.d(&quot;试纸分析出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">                    //试纸saas分析失败</span><br><span class="line">                    ToastUtils.show(getContext(), AiCode.getMessage(code));</span><br><span class="line">                   </span><br><span class="line">                &#125;</span><br><span class="line">                @Override</span><br><span class="line">                public void paperResultDialogShow(PaperResultDialog paperResultDialog) &#123;</span><br><span class="line">                    paperResultDialog.getHintTv().setGravity(Gravity.LEFT);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">  4.调用完成释放资源</span><br><span class="line"> </span><br><span class="line">    paperAnalysiserClient.closeSession();</span><br><span class="line">  5.混淆配置</span><br><span class="line">    -dontwarn  com.ikangtai.papersdk.**</span><br><span class="line">    -keep class com.ikangtai.papersdk.** &#123;*;&#125;</span><br><span class="line">    -keepclasseswithmembernames class *&#123;</span><br><span class="line">        native &lt;methods&gt;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="函数说明-1"><a href="#函数说明-1" class="headerlink" title="函数说明"></a>函数说明</h3><h4 id="主函数调用-1"><a href="#主函数调用-1" class="headerlink" title="主函数调用"></a>主函数调用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">public class PaperAnalysiserClient &#123;</span><br><span class="line">/**</span><br><span class="line"> * @param context</span><br><span class="line"> * @param appId appId</span><br><span class="line"> * @param appSecret appSecret</span><br><span class="line"> * @param unionId 用户唯一id</span><br><span class="line"> */</span><br><span class="line">public PaperAnalysiserClient(Context context, String appId, String appSecret, String unionId)；</span><br><span class="line">public PaperAnalysiserClient(Context context, String appId, String appSecret, String unionId,Config config)；</span><br><span class="line">/**</span><br><span class="line"> * 初始化</span><br><span class="line"> * @param config</span><br><span class="line"> */</span><br><span class="line">public void init(Config config);</span><br><span class="line">/**</span><br><span class="line"> * 识别试纸图片并弹出试纸识别结果弹框</span><br><span class="line"> * @param fileBitmap 试纸图片bitmap</span><br><span class="line"> * @param event 识别结果回调</span><br><span class="line"> */</span><br><span class="line">public void analysisBitmap(final Bitmap fileBitmap, final IBitmapAnalysisEvent event);</span><br><span class="line">/**</span><br><span class="line"> * 处理Camera 视频流</span><br><span class="line"> * 需要配置Config.analysisSuccessCount,默认三次成功即显示试纸识别结果</span><br><span class="line"> */</span><br><span class="line">public void analysisCameraData(final Bitmap originSquareBitmap);</span><br><span class="line">/**</span><br><span class="line"> * 从视频拍照调用手动裁剪模式</span><br><span class="line"> * @param bitmap</span><br><span class="line"> * @param upLeftPoint 左上角坐标</span><br><span class="line"> * @param rightBottomPoint 右下角坐标</span><br><span class="line"> * @param event 回调</span><br><span class="line"> */</span><br><span class="line">public void analysisClipBitmapFromCamera(Bitmap bitmap, Point upLeftPoint, Point rightBottomPoint, final IBaseAnalysisEvent event);</span><br><span class="line">/**</span><br><span class="line"> * 从相册选择调用手动裁剪模式</span><br><span class="line"> * @param bitmap</span><br><span class="line"> * @param upLeftPoint 左上角坐标</span><br><span class="line"> * @param rightBottomPoint 右下角坐标</span><br><span class="line"> * @param event 回调</span><br><span class="line"> */</span><br><span class="line">public void analysisClipBitmapFromPhoto(Bitmap bitmap, Point upLeftPoint, Point rightBottomPoint, final IBaseAnalysisEvent event);</span><br><span class="line">/**</span><br><span class="line"> * 手动修改lhValue值</span><br><span class="line"> */</span><br><span class="line">public void updatePaperValue(int paperValue) ;</span><br><span class="line">/**</span><br><span class="line"> *	试纸单周期分析算法</span><br><span class="line"> * @param papers 单周期papers</span><br><span class="line"> * @param event  回调</span><br><span class="line"> */</span><br><span class="line">public void paperCycleAnalysis(ArrayList&lt;PaperCycleAnalysisReq.Paper&gt; papers, final ICycleAnalysisResultEvent event);</span><br><span class="line">/**</span><br><span class="line"> * 停止loading加载</span><br><span class="line"> */</span><br><span class="line">public void stopShowProgressDialog() ;</span><br><span class="line">/**</span><br><span class="line"> * 完成流程关闭Session</span><br><span class="line"> */</span><br><span class="line">public void closeSession();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SDK-Config-1"><a href="#SDK-Config-1" class="headerlink" title="SDK Config"></a>SDK Config</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">//试纸sdk配置</span><br><span class="line">public class Config &#123;</span><br><span class="line">/**</span><br><span class="line"> * debug模式控制台打印日志</span><br><span class="line"> */</span><br><span class="line">private static boolean debug = true;</span><br><span class="line">/**</span><br><span class="line"> * 使用测试服</span><br><span class="line"> */</span><br><span class="line">private static boolean testServer = false;</span><br><span class="line">/**</span><br><span class="line"> * 模糊阈值</span><br><span class="line"> */</span><br><span class="line">private int blurLimitValue = 25;</span><br><span class="line">/**</span><br><span class="line"> * 连续分析成功3次</span><br><span class="line"> */</span><br><span class="line">private int analysisSuccessCount = 3;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 同一个错误码连续出现2次</span><br><span class="line"> */</span><br><span class="line">private int analysisErrorCount = 2;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 自动抠图时长15s</span><br><span class="line"> */</span><br><span class="line">private int analysisTime = 15;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 试纸存储文件夹路径</span><br><span class="line"> */</span><br><span class="line">private String filePath;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 日志存储路径</span><br><span class="line"> */</span><br><span class="line">private String logFilePath;</span><br><span class="line">/**</span><br><span class="line"> * 是否外扩</span><br><span class="line"> */</span><br><span class="line">private boolean pixelOfdExtended;</span><br><span class="line">/**</span><br><span class="line"> * 外扩像素</span><br><span class="line"> */</span><br><span class="line">private int margin;</span><br><span class="line">/**</span><br><span class="line"> * 弹框ui配置</span><br><span class="line"> */</span><br><span class="line">private UiOption uiOption;</span><br><span class="line">/**</span><br><span class="line"> * 网络请求超时时间</span><br><span class="line"> */</span><br><span class="line">private static int netTimeOut = 10;</span><br><span class="line">/**</span><br><span class="line"> * 日志文件句柄</span><br><span class="line"> */</span><br><span class="line">private Writer logWriter;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//弹框Ui配置</span><br><span class="line">public class UiOption &#123;</span><br><span class="line">/**</span><br><span class="line"> * 标题</span><br><span class="line"> */</span><br><span class="line">private String titleText;</span><br><span class="line">/**</span><br><span class="line"> * 标题颜色</span><br><span class="line"> */</span><br><span class="line">private int titleTextColor;</span><br><span class="line">/**</span><br><span class="line"> * 标尺线</span><br><span class="line"> */</span><br><span class="line">private int tagLineImageResId;</span><br><span class="line">/**</span><br><span class="line"> * t滑块图标</span><br><span class="line"> */</span><br><span class="line">private int tLineResId;</span><br><span class="line">/**</span><br><span class="line"> * c滑块图标</span><br><span class="line"> */</span><br><span class="line">private int cLineResId;</span><br><span class="line">/**</span><br><span class="line"> * 水平翻转文字</span><br><span class="line"> */</span><br><span class="line">private String flipText;</span><br><span class="line">/**</span><br><span class="line"> * 水平翻转文字颜色</span><br><span class="line"> */</span><br><span class="line">private int flipTextColor;</span><br><span class="line">/**</span><br><span class="line"> * 提示文字</span><br><span class="line"> */</span><br><span class="line">private String hintText;</span><br><span class="line">/**</span><br><span class="line"> * 提示文字颜色</span><br><span class="line"> */</span><br><span class="line">private int hintTextColor;</span><br><span class="line">/**</span><br><span class="line"> * 返回图片</span><br><span class="line"> */</span><br><span class="line">private int backResId;</span><br><span class="line">/**</span><br><span class="line"> * 确认图片</span><br><span class="line"> */</span><br><span class="line">private int confirmResId;</span><br><span class="line">/**</span><br><span class="line"> * tc线宽度</span><br><span class="line"> */</span><br><span class="line">private float tcLineWidth;</span><br><span class="line">/**</span><br><span class="line"> * 返回按钮背景</span><br><span class="line"> */</span><br><span class="line">private int backButtonBgResId;</span><br><span class="line">/**</span><br><span class="line"> * 确认按钮背景</span><br><span class="line"> */</span><br><span class="line">private int confirmButtonBgResId;</span><br><span class="line">/**</span><br><span class="line"> * 返回按钮文字</span><br><span class="line"> */</span><br><span class="line">private String backButtonText;</span><br><span class="line">/**</span><br><span class="line"> * 确认按钮文字</span><br><span class="line"> */</span><br><span class="line">private String confirmButtonText;</span><br><span class="line">/**</span><br><span class="line"> * 显示底部按钮</span><br><span class="line"> */</span><br><span class="line">private boolean visibleBottomButton;</span><br><span class="line">/**</span><br><span class="line"> * 返回按钮文字颜色</span><br><span class="line"> */</span><br><span class="line">private int backButtonTextColor;</span><br><span class="line">/**</span><br><span class="line"> * 确认按钮文字颜色</span><br><span class="line"> */</span><br><span class="line">private int confirmButtonTextColor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">//基类回调</span><br><span class="line">public interface IBaseAnalysisEvent &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 显示加载框</span><br><span class="line">     */</span><br><span class="line">    void showProgressDialog();</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 隐藏加载框</span><br><span class="line">     */</span><br><span class="line">    void dismissProgressDialog();</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 试纸结果弹框取消</span><br><span class="line">     */</span><br><span class="line">    void cancel();</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 试纸结果弹框保存</span><br><span class="line">     *</span><br><span class="line">     * @param paperResult 最终确认保存数据</span><br><span class="line">     */</span><br><span class="line">    void save(PaperResult paperResult);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * SaaS识别错误</span><br><span class="line">     * @param errorResult 错误描述</span><br><span class="line">     * @param code 错误码</span><br><span class="line">     */</span><br><span class="line">    void saasAnalysisError(String errorResult, int code);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 试纸结果确认弹框</span><br><span class="line">     * @param PaperResultDialog</span><br><span class="line">     *</span><br><span class="line">     */</span><br><span class="line">    void paperResultDialogShow(PaperResultDialog var1);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">//试纸抠图回调</span><br><span class="line">public interface IBitmapAnalysisEvent extends IBaseAnalysisEvent&#123;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 试纸抠图成功返回结果</span><br><span class="line">     *</span><br><span class="line">     * @param paperCoordinatesData 抠图结果数据，包括坐标点、模糊值</span><br><span class="line">     * @param originSquareBitmap 试纸正方形bitmap</span><br><span class="line">     * @param clipPaperBitmap 抠图试纸条</span><br><span class="line">     */</span><br><span class="line">    boolean analysisSuccess(PaperCoordinatesData paperCoordinatesData, Bitmap originSquareBitmap, Bitmap clipPaperBitmap);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 试纸抠图错误</span><br><span class="line">     * @param paperCoordinatesData 抠图结果数据，包括坐标点、模糊值可能为空</span><br><span class="line">     * @param errorResult 错误描述</span><br><span class="line">     * @param code 错误码</span><br><span class="line">     */</span><br><span class="line">    void analysisError(PaperCoordinatesData paperCoordinatesData,String errorResult, int code);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">//视频分析回调</span><br><span class="line">public interface ICameraAnalysisEvent extends IBitmapAnalysisEvent &#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * AI分析过程中产生的结果</span><br><span class="line">     *</span><br><span class="line">     * @param paperCoordinatesData</span><br><span class="line">     */</span><br><span class="line">    void analysisResult(PaperCoordinatesData paperCoordinatesData);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * AI分析15s结束</span><br><span class="line">     *</span><br><span class="line">     * @param originSquareBitmap 结束时原始正方形</span><br><span class="line">     * @param code</span><br><span class="line">     */</span><br><span class="line">    void analysisEnd(Bitmap originSquareBitmap, int code, String errorResult);</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * AI分析取消</span><br><span class="line">     *</span><br><span class="line">     * @param originSquareBitmap 取消时原始正方形</span><br><span class="line">     * @param code</span><br><span class="line">     */</span><br><span class="line">    void analysisCancel(Bitmap originSquareBitmap, int code, String errorResult);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//试纸识别结果</span><br><span class="line">public class PaperCoordinatesData &#123;</span><br><span class="line"> /**</span><br><span class="line"> * 错误码</span><br><span class="line"> */</span><br><span class="line"> private int code;</span><br><span class="line"> /**</span><br><span class="line"> * 模糊值</span><br><span class="line"> */</span><br><span class="line"> private double blurValue;</span><br><span class="line"> /**</span><br><span class="line"> * 上下左右坐标</span><br><span class="line"> */</span><br><span class="line"> private Point point1;</span><br><span class="line"> private Point point2;</span><br><span class="line"> private Point point3;</span><br><span class="line"> private Point point4;</span><br><span class="line"> /**</span><br><span class="line"> * 抠图结果mat对象，可转换成试纸条bitmap</span><br><span class="line"> */</span><br><span class="line"> private Mat imageL;</span><br><span class="line">&#125;</span><br><span class="line">//试纸识别弹框保存数据</span><br><span class="line">public class PaperResult &#123;</span><br><span class="line">    /**</span><br><span class="line"> * id</span><br><span class="line"> */</span><br><span class="line"> private String paperId;</span><br><span class="line"> /**</span><br><span class="line"> * 试纸时间</span><br><span class="line"> */</span><br><span class="line"> private String paperTime;</span><br><span class="line"> /**</span><br><span class="line"> * 错误码</span><br><span class="line"> */</span><br><span class="line"> private int errNo;</span><br><span class="line"> /**</span><br><span class="line"> * 错误描述</span><br><span class="line"> */</span><br><span class="line"> private String errMsg;</span><br><span class="line"> /**</span><br><span class="line"> * tc线比例</span><br><span class="line"> */</span><br><span class="line"> private double tLinePos;</span><br><span class="line"> private double cLinePos;</span><br><span class="line"> /**</span><br><span class="line"> * 试纸类型</span><br><span class="line"> */</span><br><span class="line"> private int paperType;</span><br><span class="line"> /**</span><br><span class="line"> * 失败结果</span><br><span class="line"> */</span><br><span class="line"> private double paperValue;</span><br><span class="line"> /**</span><br><span class="line"> * ratio结果</span><br><span class="line"> */</span><br><span class="line"> private double ratioValue;</span><br><span class="line"> /**</span><br><span class="line"> * 是否翻转</span><br><span class="line"> */</span><br><span class="line"> private boolean flip;</span><br><span class="line"> /**</span><br><span class="line"> * 模糊度</span><br><span class="line"> */</span><br><span class="line"> private double blurValue;</span><br><span class="line"> /**</span><br><span class="line"> * 试纸抠图结果</span><br><span class="line"> */</span><br><span class="line"> private Bitmap paperBitmap;</span><br><span class="line"> /**</span><br><span class="line"> * 试纸抠图不加margin结果</span><br><span class="line"> */</span><br><span class="line"> private Bitmap noMarginBitmap;</span><br><span class="line"> /**</span><br><span class="line"> * tc线左右边界位置</span><br><span class="line"> */</span><br><span class="line"> private double clineLeft;</span><br><span class="line"> private double clineRight;</span><br><span class="line"> private double tlineLeft;</span><br><span class="line"> private double tlineRight;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="错误描述-1"><a href="#错误描述-1" class="headerlink" title="错误描述"></a>错误描述</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">//图片错误</span><br><span class="line">codes.put(CODE_IMAGE_ERROR, &quot;图片错误&quot;);</span><br><span class="line">//未知错误</span><br><span class="line">codes.put(CODE_ERROR, &quot;未知错误&quot;);</span><br><span class="line">//抠图成功</span><br><span class="line">codes.put(CODE_0, &quot;抠图成功&quot;);</span><br><span class="line">//没有试纸；错误提示文案：没有找到试纸</span><br><span class="line">codes.put(CODE_1, &quot;没有找到试纸&quot;);</span><br><span class="line">//距离过远；错误提示文案：距离过远，请调整拍摄距离</span><br><span class="line">codes.put(CODE_2, &quot;距离过远，请调整拍摄距离&quot;);</span><br><span class="line">// 背景过脏；错误提示文案：背景有干扰，请在浅色纯背景下拍摄</span><br><span class="line">codes.put(CODE_3, &quot;背景有干扰，请在浅色纯背景下拍摄&quot;);</span><br><span class="line">// 距离过近；错误提示文案：距离过近，请调整拍摄距离</span><br><span class="line">codes.put(CODE_4, &quot;距离过近，请调整拍摄距离&quot;);</span><br><span class="line">//有残缺；错误提示文案：试纸不全，请保持全部试纸处在取景框内</span><br><span class="line">codes.put(CODE_5, &quot;试纸不全，请保持全部试纸处在取景框内&quot;);</span><br><span class="line">// 神经网络处理错误；错误提示文案：算法处理中，请稍候</span><br><span class="line">codes.put(CODE_6, &quot;算法处理中，请稍候&quot;);</span><br><span class="line">// 两张试纸；错误提示文案：一次只能拍摄一张试纸</span><br><span class="line">codes.put(CODE_7, &quot;一次只能拍摄一张试纸&quot;);</span><br><span class="line">// 曝光不足；错误提示文案：光线太暗，请调整光线或打开闪光灯后拍摄</span><br><span class="line">codes.put(CODE_8, &quot;光线太暗，请调整光线或打开闪光灯后拍摄&quot;);</span><br><span class="line">// 曝光过度；错误提示文案：光线太强，请调整光线或关掉闪光灯后拍摄</span><br><span class="line">codes.put(CODE_9, &quot;光线太强，请调整光线或关掉闪光灯后拍摄&quot;);</span><br><span class="line">// 试纸局部过度曝光；错误提示文案：局部光线太强，请调整光线或关掉闪光灯后拍摄</span><br><span class="line">codes.put(CODE_10, &quot;局部光线太强，请调整光线或关掉闪光灯后拍摄&quot;);</span><br><span class="line">// 画面模糊；错误提示文案：画面模糊，请保持手机稳定或重新对焦</span><br><span class="line">codes.put(CODE_11, &quot;画面模糊，请保持手机稳定或重新对焦&quot;);</span><br><span class="line">// 曝光不足；错误提示文案：光线太暗，请调整光线或打开闪光灯后拍摄</span><br><span class="line">codes.put(CODE_12, &quot;光线太暗，请调整光线或打开闪光灯后拍摄&quot;);</span><br><span class="line">//视频流扫描超时</span><br><span class="line">codes.put(CODE_17, &quot;视频流扫描超时&quot;);</span><br><span class="line">/// 手动裁剪失败，请检查传入的图片和坐标点</span><br><span class="line">codes.put(CODE_50, &quot;手动裁剪失败，请检查传入的图片和坐标点&quot;);</span><br><span class="line">//抠图成功，分析成功，但是用户取消确认抠图和分析结果。</span><br><span class="line">codes.put(CODE_201, &quot;用户取消&quot;);</span><br><span class="line">//抠图成功，分析成功，但未检测到参考线，请确认试纸有参考线显示</span><br><span class="line">codes.put(CODE_202, &quot;未检测到参考线，请确认试纸有参考线显示&quot;);</span><br><span class="line">//抠图成功，但是分析失败</span><br><span class="line">codes.put(CODE_101, &quot;试纸分析出错&quot;);</span><br><span class="line">//SDK 校验失败或无效</span><br><span class="line">codes.put(CODE_SDK_ERROR, &quot;SDK 校验失败或无效&quot;);</span><br><span class="line">//网络错误</span><br><span class="line">codes.put(CODE_NET_ERROR, &quot;网络错误&quot;);</span><br><span class="line">codes.put(CODE_501, &quot;缺少相关参数&quot;);</span><br><span class="line">codes.put(CODE_503, &quot;频率过高，关入小黑屋&quot;);</span><br><span class="line">codes.put(CODE_500, &quot;认证错误&quot;);</span><br><span class="line">codes.put(CODE_502, &quot;超时，认证无效&quot;);</span><br><span class="line">codes.put(CODE_301, &quot;参数不合法&quot;);</span><br><span class="line">codes.put(CODE_302, &quot;分析结果转化json出错&quot;);</span><br><span class="line">codes.put(CODE_303, &quot;分析失败，服务返回&quot;);</span><br><span class="line">codes.put(CODE_304, &quot;图片base64编解码失败&quot;);</span><br><span class="line">codes.put(CODE_510, &quot;分析失败&quot;);</span><br><span class="line">codes.put(CODE_511, &quot;试纸无效&quot;);</span><br><span class="line"> </span><br><span class="line">通过AiCode.getMessage(CODE)获取错误描述</span><br></pre></td></tr></table></figure>
<h3 id="调用场景代码片段-1"><a href="#调用场景代码片段-1" class="headerlink" title="调用场景代码片段"></a>调用场景代码片段</h3><h4 id="“抠图模式”代码调用片段-1"><a href="#“抠图模式”代码调用片段-1" class="headerlink" title="“抠图模式”代码调用片段"></a>“抠图模式”代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">&quot;智能扫描&quot;代码调用片段</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 在Camera实时预览回调进行识别抠图识别</span><br><span class="line"> */</span><br><span class="line">private Camera.PreviewCallback mPreviewCallback = new Camera.PreviewCallback() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onPreviewFrame(final byte[] data, final Camera camera) &#123;</span><br><span class="line">        if (paperAnalysiserClient.isObtainPreviewFrame()) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        //视频上半部分正方形图片</span><br><span class="line">        Bitmap originSquareBitmap = TensorFlowTools.convertFrameToBitmap(data, camera, surfaceView.getWidth(), surfaceView.getHeight(), TensorFlowTools.getDegree(getActivity()));</span><br><span class="line">        paperAnalysiserClient.analysisCameraData(originSquareBitmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">//抠图结果回调</span><br><span class="line">private ICameraAnalysisEvent iCameraAnalysisEvent = new ICameraAnalysisEvent() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean analysisSuccess(PaperCoordinatesData paperCoordinatesData, Bitmap originSquareBitmap, Bitmap clipPaperBitmap) &#123;</span><br><span class="line">        if (scanMode == MANUALSMART) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        LogUtils.d(&quot;试纸自动抠图成功&quot;);</span><br><span class="line">        ToastUtils.show(getContext(), &quot;抠图最终结果&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void analysisResult(PaperCoordinatesData paperCoordinatesData) &#123;</span><br><span class="line">        if (scanMode == MANUALSMART) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        LogUtils.d(&quot;试纸自动抠图画线&quot;);</span><br><span class="line">        Log.d(&quot;xyl&quot;, &quot;抠图耗时 &quot; + (System.currentTimeMillis() - startTime));</span><br><span class="line">        ToastUtils.show(getContext(), &quot;抠图中间结果&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void analysisEnd(Bitmap originSquareBitmap, int code, String errorResult) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸抠图结束 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        ToastUtils.show(getContext(), &quot;抠图超时&quot;);</span><br><span class="line">        scanMode = MANUALSMART;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void analysisCancel(Bitmap originSquareBitmap, int code, String errorResult) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸抠图取消 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        ToastUtils.show(getContext(), &quot;切换抠图模式，取消视频流分析&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void showProgressDialog() &#123;</span><br><span class="line">        LogUtils.d(&quot;Show Loading Dialog&quot;);</span><br><span class="line">		that.showProgressDialog(new View.OnClickListener() &#123;</span><br><span class="line"></span><br><span class="line">			@Override</span><br><span class="line">			public void onClick(View v) &#123;</span><br><span class="line">				//停止网络请求</span><br><span class="line">				paperAnalysiserClient.stopShowProgressDialog();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void dismissProgressDialog() &#123;</span><br><span class="line">        LogUtils.d(&quot;Hide Loading Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void cancel() &#123;</span><br><span class="line">        LogUtils.d(&quot;取消试纸结果确认&quot;);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void save(PaperResult paperResult) &#123;</span><br><span class="line">        LogUtils.d(&quot;保存试纸分析结果：\n&quot; + paperResult.toString());</span><br><span class="line">        smartPaperMeasureContainerLayout.showAutoSmartPaperMeasure(null, null);</span><br><span class="line">        if (paperResult.getErrNo() != 0) &#123;</span><br><span class="line">            ToastUtils.show(getContext(), AiCode.getMessage(paperResult.getErrNo()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void analysisError(PaperCoordinatesData paperCoordinatesData, String errorResult, int code) &#123;</span><br><span class="line">        if (scanMode == MANUALSMART) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        LogUtils.d(&quot;试纸抠图出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        LogUtils.d(&quot;抠图耗时 &quot; + (System.currentTimeMillis() - startTime));</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void saasAnalysisError(String errorResult, int code) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸分析错误 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        ToastUtils.show(getContext(), errorResult + code);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void paperResultDialogShow(PaperResultDialog paperResultDialog) &#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">paperAnalysiserClient.setCameraDataCallback(iCameraAnalysisEvent);</span><br></pre></td></tr></table></figure>
<p>`</p>
<h4 id="“裁剪模式”代码调用片段-1"><a href="#“裁剪模式”代码调用片段-1" class="headerlink" title="“裁剪模式”代码调用片段"></a>“裁剪模式”代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&quot;手动裁剪模式&quot;代码调用片段</span><br><span class="line">//从相册选择抠图失败手动裁剪模式试纸识别</span><br><span class="line">paperAnalysiserClient.analysisClipBitmapFromPhoto(clipBitmap, upLeftPoint, rightBottomPoint, new IBaseAnalysisEvent() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void showProgressDialog() &#123;</span><br><span class="line">        LogUtils.d(&quot;Show Loading Dialog&quot;);</span><br><span class="line">		that.showProgressDialog(new View.OnClickListener() &#123;</span><br><span class="line"></span><br><span class="line">			@Override</span><br><span class="line">			public void onClick(View v) &#123;</span><br><span class="line">				//停止网络请求</span><br><span class="line">				paperAnalysiserClient.stopShowProgressDialog();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void dismissProgressDialog() &#123;</span><br><span class="line">        LogUtils.d(&quot;Hide Loading Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void cancel() &#123;</span><br><span class="line">        LogUtils.d(&quot;取消试纸结果确认&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void save(PaperResult paperResult) &#123;</span><br><span class="line">        LogUtils.d(&quot;保存试纸分析结果：\n&quot;+paperResult.toString());</span><br><span class="line">        if (paperResult.getErrNo() != 0) &#123;</span><br><span class="line">            ToastUtils.show(getContext(), AiCode.getMessage(paperResult.getErrNo()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void saasAnalysisError(String errorResult, int code) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸分析出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void paperResultDialogShow(PaperResultDialog paperResultDialog) &#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">//从视频拍照页面手动裁剪模式试纸识别</span><br><span class="line">paperAnalysiserClient.analysisClipBitmapFromCamera(fileBitmap, upLeftPoint, rightBottomPoint, new IBaseAnalysisEvent() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void showProgressDialog() &#123;</span><br><span class="line">        LogUtils.d(&quot;Show Loading Dialog&quot;);</span><br><span class="line">		that.showProgressDialog(new View.OnClickListener() &#123;</span><br><span class="line"></span><br><span class="line">			@Override</span><br><span class="line">			public void onClick(View v) &#123;</span><br><span class="line">				//停止网络请求</span><br><span class="line">				paperAnalysiserClient.stopShowProgressDialog();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void dismissProgressDialog() &#123;</span><br><span class="line">        LogUtils.d(&quot;Show Loading Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void cancel() &#123;</span><br><span class="line">        LogUtils.d(&quot;取消试纸结果确认&quot;);</span><br><span class="line">        ToastUtils.show(getContext(), AiCode.getMessage(AiCode.CODE_201));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void save(PaperResult paperResult) &#123;</span><br><span class="line">        LogUtils.d(&quot;保存试纸分析结果：\n&quot; + paperResult.toString());</span><br><span class="line">        if (paperResult.getErrNo() != 0) &#123;</span><br><span class="line">            ToastUtils.show(getContext(), AiCode.getMessage(paperResult.getErrNo()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void saasAnalysisError(String errorResult, int code) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸分析出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        ToastUtils.show(getContext(), AiCode.getMessage(code));</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void paperResultDialogShow(PaperResultDialog paperResultDialog) &#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>`</p>
<h4 id="“图片选择模式”代码调用片段-1"><a href="#“图片选择模式”代码调用片段-1" class="headerlink" title="“图片选择模式”代码调用片段"></a>“图片选择模式”代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&quot;图片选择模式&quot;代码调用片段</span><br><span class="line">paperAnalysiserClient.analysisBitmap(fileBitmap, new IBitmapAnalysisEvent() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void showProgressDialog() &#123;</span><br><span class="line">        //显示加载框</span><br><span class="line">        LogUtils.d(&quot;Show Loading Dialog&quot;);</span><br><span class="line">		that.showProgressDialog(new View.OnClickListener() &#123;</span><br><span class="line"></span><br><span class="line">			@Override</span><br><span class="line">			public void onClick(View v) &#123;</span><br><span class="line">				//停止网络请求</span><br><span class="line">				paperAnalysiserClient.stopShowProgressDialog();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void dismissProgressDialog() &#123;</span><br><span class="line">        //隐藏加载框</span><br><span class="line">        LogUtils.d(&quot;Hide Loading Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void cancel() &#123;</span><br><span class="line">        LogUtils.d(&quot;取消试纸结果确认&quot;);</span><br><span class="line">        //试纸结果确认框取消</span><br><span class="line">        ToastUtils.show(getContext(), AiCode.getMessage(AiCode.CODE_201));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void save(PaperResult paperResult) &#123;</span><br><span class="line">        LogUtils.d(&quot;保存试纸分析结果：\n&quot;+paperResult.toString());</span><br><span class="line">        if (paperResult.getErrNo() != 0) &#123;</span><br><span class="line">            ToastUtils.show(getContext(), AiCode.getMessage(paperResult.getErrNo()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public boolean analysisSuccess(PaperCoordinatesData paperCoordinatesData, Bitmap originSquareBitmap, Bitmap clipPaperBitmap) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸自动抠图成功&quot;);</span><br><span class="line">        //试纸抠图成功结果</span><br><span class="line">        endTime = System.currentTimeMillis();</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void analysisError(PaperCoordinatesData paperCoordinatesData, String errorResult, int code) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸自动抠图出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        //试纸抠图失败结果</span><br><span class="line">        ToastUtils.show(getContext(), AiCode.getMessage(code));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void saasAnalysisError(String errorResult, int code) &#123;</span><br><span class="line">        LogUtils.d(&quot;试纸分析出错 code：&quot; + code + &quot; errorResult:&quot; + errorResult);</span><br><span class="line">        //试纸saas分析失败</span><br><span class="line">        ToastUtils.show(getContext(), AiCode.getMessage(code));</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void paperResultDialogShow(PaperResultDialog paperResultDialog) &#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>`</p>
<h4 id="“试纸结果识别确认框”样式代码调用片段-1"><a href="#“试纸结果识别确认框”样式代码调用片段-1" class="headerlink" title="“试纸结果识别确认框”样式代码调用片段"></a>“试纸结果识别确认框”样式代码调用片段</h4><p>`</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">//定制试纸Ui显示</span><br><span class="line">/**</span><br><span class="line"> ``* 标题</span><br><span class="line">  */</span><br><span class="line">String titleText = getContext().getString(com.ikangtai.papersdk.R.string.paper_result_dialog_title);</span><br><span class="line">/**</span><br><span class="line"> * 标题颜色</span><br><span class="line"> */</span><br><span class="line">int titleTextColor = getContext().getResources().getColor(com.ikangtai.papersdk.R.color.color_444444);</span><br><span class="line">/**</span><br><span class="line"> * 标尺线</span><br><span class="line"> */</span><br><span class="line">int tagLineImageResId = com.ikangtai.papersdk.R.drawable.paper_line;</span><br><span class="line">/**</span><br><span class="line"> * t滑块图标</span><br><span class="line"> */</span><br><span class="line">int tLineResId = com.ikangtai.papersdk.R.drawable.test_paper_t_line;</span><br><span class="line">/**</span><br><span class="line"> * c滑块图标</span><br><span class="line"> */</span><br><span class="line">int cLineResId = com.ikangtai.papersdk.R.drawable.test_paper_c_line;</span><br><span class="line">/**</span><br><span class="line"> * 水平翻转文字</span><br><span class="line"> */</span><br><span class="line">String flipText = getContext().getString(com.ikangtai.papersdk.R.string.paper_result_dialog_flip);</span><br><span class="line">/**</span><br><span class="line"> * 水平翻转文字颜色</span><br><span class="line"> */</span><br><span class="line">int flipTextColor = getContext().getResources().getColor(com.ikangtai.papersdk.R.color.color_67A3FF);</span><br><span class="line">/**</span><br><span class="line"> * 提示文字</span><br><span class="line"> */</span><br><span class="line">String hintText = getContext().getString(com.ikangtai.papersdk.R.string.paper_result_dialog_hit);</span><br><span class="line">/**</span><br><span class="line"> * 提示文字颜色</span><br><span class="line"> */</span><br><span class="line">int hintTextColor = getContext().getResources().getColor(com.ikangtai.papersdk.R.color.color_444444);</span><br><span class="line">/**</span><br><span class="line"> * 返回图片</span><br><span class="line"> */</span><br><span class="line">int backResId = com.ikangtai.papersdk.R.drawable.test_paper_return;</span><br><span class="line">/**</span><br><span class="line"> * 确认图片</span><br><span class="line"> */</span><br><span class="line">int confirmResId = com.ikangtai.papersdk.R.drawable.test_paper_confirm;</span><br><span class="line">/**</span><br><span class="line"> * tc线默认值宽度</span><br><span class="line"> */</span><br><span class="line">float tcLineWidth = getContext().getResources().getDimension(com.ikangtai.papersdk.R.dimen.dp_2);</span><br><span class="line">/**</span><br><span class="line"> * 返回按钮背景</span><br><span class="line"> */</span><br><span class="line">int backButtonBgResId = com.ikangtai.papersdk.R.drawable.paper_button_drawable;</span><br><span class="line">/**</span><br><span class="line"> * 确认按钮背景</span><br><span class="line"> */</span><br><span class="line">int confirmButtonBgResId = com.ikangtai.papersdk.R.drawable.paper_button_drawable;</span><br><span class="line">/**</span><br><span class="line"> * 返回按钮文字</span><br><span class="line"> */</span><br><span class="line">String backButtonText = getContext().getString(com.ikangtai.papersdk.R.string.paper_result_back);</span><br><span class="line">/**</span><br><span class="line"> * 确认按钮文字</span><br><span class="line"> */</span><br><span class="line">String confirmButtonText = getContext().getString(com.ikangtai.papersdk.R.string.paper_result_confirm);</span><br><span class="line">/**</span><br><span class="line"> * 返回按钮文字颜色</span><br><span class="line"> */</span><br><span class="line">int backButtonTextColor = getContext().getResources().getColor(com.ikangtai.papersdk.R.color.color_444444);</span><br><span class="line">/**</span><br><span class="line"> * 确认按钮文字颜色</span><br><span class="line"> */</span><br><span class="line">int confirmButtonTextColor = getContext().getResources().getColor(com.ikangtai.papersdk.R.color.color_444444);</span><br><span class="line">/**</span><br><span class="line"> * 显示底部按钮</span><br><span class="line"> */</span><br><span class="line">boolean visibleBottomButton = false;</span><br><span class="line"> </span><br><span class="line">UiOption uiOption = new UiOption.Builder()</span><br><span class="line">        .titleText(titleText)</span><br><span class="line">        .tagLineImageResId(tagLineImageResId)</span><br><span class="line">        .titleTextColor(titleTextColor)</span><br><span class="line">        .tLineResId(tLineResId)</span><br><span class="line">        .cLineResId(cLineResId)</span><br><span class="line">        .flipText(flipText)</span><br><span class="line">        .flipTextColor(flipTextColor)</span><br><span class="line">        .hintText(hintText)</span><br><span class="line">        .hintTextColor(hintTextColor)</span><br><span class="line">        .backResId(backResId)</span><br><span class="line">        .confirmResId(confirmResId)</span><br><span class="line">        .tcLineWidth(tcLineWidth)</span><br><span class="line">        .backButtonBgResId(backButtonBgResId)</span><br><span class="line">        .backButtonText(backButtonText)</span><br><span class="line">        .confirmButtonBgResId(confirmButtonBgResId)</span><br><span class="line">        .confirmButtonText(confirmButtonText)</span><br><span class="line">        .backButtonTextColor(backButtonTextColor)</span><br><span class="line">        .confirmButtonTextColor(confirmButtonTextColor)</span><br><span class="line">        .visibleBottomButton(visibleBottomButton)</span><br><span class="line">        .build();</span><br><span class="line">//试纸识别sdk相关配置</span><br><span class="line">Config config = new Config.Builder().pixelOfdExtended(true).margin(10).uiOption(uiOption).build();</span><br><span class="line">//初始化sdk</span><br><span class="line">paperAnalysiserClient = new PaperAnalysiserClient(getContext(), AppConstant.appId, AppConstant.appSecret, &quot;xyl1@qq.com&quot;,config);</span><br></pre></td></tr></table></figure>
<p>`</p>
<h3 id="如何debug-1"><a href="#如何debug-1" class="headerlink" title="如何debug"></a>如何debug</h3><p>-log tag：paper-analysis-log<br>-log默认路径：/data/Android/pageName/files/Documents/log.txt,通过LogUtils.getLogFilePath()获取到<br>-可以自定义log 文件写入流new Config.Builder().logWriter()，或者设置log文件路径：new Config.Builder().logFilePath()</p>
<h1 id="术语说明"><a href="#术语说明" class="headerlink" title="术语说明"></a>术语说明</h1><p>N/A</p>
<h1 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><h2 id="抠图模式的网络传输量大吗"><a href="#抠图模式的网络传输量大吗" class="headerlink" title="抠图模式的网络传输量大吗?"></a>抠图模式的网络传输量大吗?</h2><p>在抠图模式下，我们的SDK一次识别仅仅传输很小的试纸条（注意不是全景图，而是抠出的试纸条），仅仅这个这个小小的试纸条会被发送到云端做识别，所以整个网络传输200K都不到，这是一个非常小的网络传输；而视频流仅仅在本地做识别，没有任何的网络传输。</p>
<h2 id="关于代码中unionID的说明"><a href="#关于代码中unionID的说明" class="headerlink" title="关于代码中unionID的说明"></a>关于代码中unionID的说明</h2><p>对于调用方来说，调用方负责uniondID的生成，uniodID有以下约束：</p>
<ul>
<li>每一个用户有一个独立的unionID，该unionID不可与其他用户的unionID重复，并且在该用户的整个生命周期内该unionID应该是始终保持不变；</li>
<li>孕橙要求uniodID字符串最大长度是45，以16进制表示的话最短是40个字节，一个最简单的unionID的生成方式就是SHA1(userID)；</li>
<li>unionID的作用：<ul>
<li>是为了保证shecare SAAS可以全生命周期的追踪这个用户的试纸数据，为用户单周期的试纸解读提供一个基本的数据备份；</li>
<li>一旦用户出现问题，可以更方便以及快速的去debug以定位原因；</li>
</ul>
</li>
</ul>
<h2 id="如何查看Debug日志"><a href="#如何查看Debug日志" class="headerlink" title="如何查看Debug日志?"></a>如何查看Debug日志?</h2><p>在我们的体验Demo里面，可以直接看到我们的API输出结果</p>
<h2 id="OpenCV兼容性问题"><a href="#OpenCV兼容性问题" class="headerlink" title="OpenCV兼容性问题"></a>OpenCV兼容性问题</h2><p>Android OpenCV版本 ：3.2.0</p>
<h2 id="测试环境和正式环境区别"><a href="#测试环境和正式环境区别" class="headerlink" title="测试环境和正式环境区别"></a>测试环境和正式环境区别</h2><h2 id="SDK识别调用频率限制"><a href="#SDK识别调用频率限制" class="headerlink" title="SDK识别调用频率限制"></a>SDK识别调用频率限制</h2><p> 同一IP限制200次/分钟</p>
<h2 id="输入的试纸图片数据是正方形"><a href="#输入的试纸图片数据是正方形" class="headerlink" title="输入的试纸图片数据是正方形"></a>输入的试纸图片数据是正方形</h2><p>Shecare SDK识别库是在正方形图片基础上进行的机器学习，抠图识别正方形正确率也会比较高，暂时只保证正方形抠图结果的正确性</p>
<h2 id="输入试纸图片文件大小限制"><a href="#输入试纸图片文件大小限制" class="headerlink" title="输入试纸图片文件大小限制"></a>输入试纸图片文件大小限制</h2><p>限制输入图片大小在5M以内</p>
<h2 id="输出抠图结果试纸条分辨率"><a href="#输出抠图结果试纸条分辨率" class="headerlink" title="输出抠图结果试纸条分辨率"></a>输出抠图结果试纸条分辨率</h2><p>Android SDK会把宽度限制在1080以内，防止处理大图出现OOM</p>
<h2 id="输出抠图试纸太窄"><a href="#输出抠图试纸太窄" class="headerlink" title="输出抠图试纸太窄"></a>输出抠图试纸太窄</h2><p>可以控制SDK输出试纸条外扩像素，实现试纸条有一定的外边距</p>
<p>Android:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new Config.Builder().pixelOfdExtended(true).margin(10)</span><br></pre></td></tr></table></figure>
<h2 id="输出抠图结果试纸条会出现透明缺角"><a href="#输出抠图结果试纸条会出现透明缺角" class="headerlink" title="输出抠图结果试纸条会出现透明缺角"></a>输出抠图结果试纸条会出现透明缺角</h2><p>在进行试纸外扩的时候，需要使用试纸抠图坐标数据转换，造成了可能会丢失一些边角</p>
<h2 id="试纸在复杂背景抠图结果可能不一致"><a href="#试纸在复杂背景抠图结果可能不一致" class="headerlink" title="试纸在复杂背景抠图结果可能不一致"></a>试纸在复杂背景抠图结果可能不一致</h2><p>识别算法也在学习升级过程中，如有出错率比较大的照片，麻烦联系客服提供原始照片，Shecare这边会对算法相应学习</p>
<h2 id="试纸logo类型未定义"><a href="#试纸logo类型未定义" class="headerlink" title="试纸logo类型未定义"></a>试纸logo类型未定义</h2><p>联系对接客服，提供相应的LOGO图片素材，进行试纸LOGO打标学习</p>
<h2 id="替换或隐藏试纸结果确认框样例说明"><a href="#替换或隐藏试纸结果确认框样例说明" class="headerlink" title="替换或隐藏试纸结果确认框样例说明"></a>替换或隐藏试纸结果确认框样例说明</h2><p>联系对接客服，进行相关配置</p>
<h2 id="替换或隐藏power-by-shecare说明"><a href="#替换或隐藏power-by-shecare说明" class="headerlink" title="替换或隐藏power by shecare说明"></a>替换或隐藏power by shecare说明</h2><p>联系对接客服，进行相关配置</p>
<h2 id="APP添加信任"><a href="#APP添加信任" class="headerlink" title="APP添加信任"></a>APP添加信任</h2><p>正常情况下，由于iOS的APP是由测试证书打包的，所以无法启动，需要改动以下设置才可以保证demo正常运行，具体设置如下图示：</p>
<p><img src="https://yunchengfile.oss-cn-beijing.aliyuncs.com/sdk/image2019-11-29_12-4-23.png" alt=""></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/25/Shecare-Saas-LHPaper-Client-SDK-Movie/" rel="next" title="孕橙智能试纸识别算法之客户端API说明(视频流版)">
                <i class="fa fa-chevron-left"></i> 孕橙智能试纸识别算法之客户端API说明(视频流版)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/19/Shecare-LHPaper-plugin-SDK/" rel="prev" title="孕橙试纸小程序插件">
                孕橙试纸小程序插件 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">iKangtai</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SDK简介"><span class="nav-number">1.</span> <span class="nav-text">SDK简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SDK更新日志"><span class="nav-number">2.</span> <span class="nav-text">SDK更新日志</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iOS"><span class="nav-number">2.1.</span> <span class="nav-text">iOS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android"><span class="nav-number">2.2.</span> <span class="nav-text">Android</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#支持平台"><span class="nav-number">3.</span> <span class="nav-text">支持平台</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#体验DEMO安装"><span class="nav-number">4.</span> <span class="nav-text">体验DEMO安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iOS安装"><span class="nav-number">4.1.</span> <span class="nav-text">iOS安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#下载地址"><span class="nav-number">4.1.1.</span> <span class="nav-text">下载地址</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android安装"><span class="nav-number">4.2.</span> <span class="nav-text">Android安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#下载地址-1"><span class="nav-number">4.2.1.</span> <span class="nav-text">下载地址</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试图片下载"><span class="nav-number">4.3.</span> <span class="nav-text">测试图片下载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三种识别模式"><span class="nav-number">4.4.</span> <span class="nav-text">三种识别模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#智能扫描模式"><span class="nav-number">4.5.</span> <span class="nav-text">智能扫描模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#手动裁剪模式"><span class="nav-number">4.6.</span> <span class="nav-text">手动裁剪模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#选择图片模式"><span class="nav-number">4.7.</span> <span class="nav-text">选择图片模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#试纸识别结果确认框"><span class="nav-number">4.8.</span> <span class="nav-text">试纸识别结果确认框</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#调用流程"><span class="nav-number">5.</span> <span class="nav-text">调用流程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#流程图"><span class="nav-number">5.1.</span> <span class="nav-text">流程图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#输入参数是图片的API流程"><span class="nav-number">5.1.0.1.</span> <span class="nav-text">输入参数是图片的API流程</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#流程描述"><span class="nav-number">5.1.0.1.1.</span> <span class="nav-text">流程描述</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入参数是视频流的API流程图"><span class="nav-number">5.1.0.2.</span> <span class="nav-text">输入参数是视频流的API流程图</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#流程描述-1"><span class="nav-number">5.1.0.2.1.</span> <span class="nav-text">流程描述</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模块结构图"><span class="nav-number">6.</span> <span class="nav-text">模块结构图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#模块描述"><span class="nav-number">6.1.</span> <span class="nav-text">模块描述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#试纸识别API"><span class="nav-number">6.1.1.</span> <span class="nav-text">试纸识别API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#错误反馈机制"><span class="nav-number">6.1.2.</span> <span class="nav-text">错误反馈机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shecare-Cloud模块"><span class="nav-number">6.1.3.</span> <span class="nav-text">Shecare Cloud模块</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#定制试纸识别结果确认框"><span class="nav-number">7.</span> <span class="nav-text">定制试纸识别结果确认框</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#对话框说明"><span class="nav-number">7.1.</span> <span class="nav-text">对话框说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#相关配置项"><span class="nav-number">7.2.</span> <span class="nav-text">相关配置项</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#试纸识别值的映射"><span class="nav-number">8.</span> <span class="nav-text">试纸识别值的映射</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SDK代码说明"><span class="nav-number">9.</span> <span class="nav-text">SDK代码说明</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iOS-1"><span class="nav-number">9.1.</span> <span class="nav-text">iOS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#代码示例"><span class="nav-number">9.1.1.</span> <span class="nav-text">代码示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数说明"><span class="nav-number">9.1.2.</span> <span class="nav-text">函数说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SDK-Config"><span class="nav-number">9.1.2.1.</span> <span class="nav-text">SDK Config</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#主函数调用"><span class="nav-number">9.1.2.2.</span> <span class="nav-text">主函数调用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#返回值"><span class="nav-number">9.1.2.3.</span> <span class="nav-text">返回值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#错误描述"><span class="nav-number">9.1.2.4.</span> <span class="nav-text">错误描述</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#调用场景代码片段"><span class="nav-number">9.1.3.</span> <span class="nav-text">调用场景代码片段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#“抠图模式”代码调用片段"><span class="nav-number">9.1.3.1.</span> <span class="nav-text">“抠图模式”代码调用片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“裁剪模式”代码调用片段"><span class="nav-number">9.1.3.2.</span> <span class="nav-text">“裁剪模式”代码调用片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“图片选择模式”代码调用片段"><span class="nav-number">9.1.3.3.</span> <span class="nav-text">“图片选择模式”代码调用片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“试纸结果识别确认框”样式代码调用片段"><span class="nav-number">9.1.3.4.</span> <span class="nav-text">“试纸结果识别确认框”样式代码调用片段</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何debug"><span class="nav-number">9.1.4.</span> <span class="nav-text">如何debug</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android-1"><span class="nav-number">9.2.</span> <span class="nav-text">Android</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#代码示例-1"><span class="nav-number">9.2.1.</span> <span class="nav-text">代码示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数说明-1"><span class="nav-number">9.2.2.</span> <span class="nav-text">函数说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主函数调用-1"><span class="nav-number">9.2.2.1.</span> <span class="nav-text">主函数调用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SDK-Config-1"><span class="nav-number">9.2.2.2.</span> <span class="nav-text">SDK Config</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#错误描述-1"><span class="nav-number">9.2.2.3.</span> <span class="nav-text">错误描述</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#调用场景代码片段-1"><span class="nav-number">9.2.3.</span> <span class="nav-text">调用场景代码片段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#“抠图模式”代码调用片段-1"><span class="nav-number">9.2.3.1.</span> <span class="nav-text">“抠图模式”代码调用片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“裁剪模式”代码调用片段-1"><span class="nav-number">9.2.3.2.</span> <span class="nav-text">“裁剪模式”代码调用片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“图片选择模式”代码调用片段-1"><span class="nav-number">9.2.3.3.</span> <span class="nav-text">“图片选择模式”代码调用片段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#“试纸结果识别确认框”样式代码调用片段-1"><span class="nav-number">9.2.3.4.</span> <span class="nav-text">“试纸结果识别确认框”样式代码调用片段</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何debug-1"><span class="nav-number">9.2.4.</span> <span class="nav-text">如何debug</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#术语说明"><span class="nav-number">10.</span> <span class="nav-text">术语说明</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Q-amp-A"><span class="nav-number">11.</span> <span class="nav-text">Q&amp;A</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#抠图模式的网络传输量大吗"><span class="nav-number">11.1.</span> <span class="nav-text">抠图模式的网络传输量大吗?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#关于代码中unionID的说明"><span class="nav-number">11.2.</span> <span class="nav-text">关于代码中unionID的说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何查看Debug日志"><span class="nav-number">11.3.</span> <span class="nav-text">如何查看Debug日志?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenCV兼容性问题"><span class="nav-number">11.4.</span> <span class="nav-text">OpenCV兼容性问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试环境和正式环境区别"><span class="nav-number">11.5.</span> <span class="nav-text">测试环境和正式环境区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SDK识别调用频率限制"><span class="nav-number">11.6.</span> <span class="nav-text">SDK识别调用频率限制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输入的试纸图片数据是正方形"><span class="nav-number">11.7.</span> <span class="nav-text">输入的试纸图片数据是正方形</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输入试纸图片文件大小限制"><span class="nav-number">11.8.</span> <span class="nav-text">输入试纸图片文件大小限制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输出抠图结果试纸条分辨率"><span class="nav-number">11.9.</span> <span class="nav-text">输出抠图结果试纸条分辨率</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输出抠图试纸太窄"><span class="nav-number">11.10.</span> <span class="nav-text">输出抠图试纸太窄</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输出抠图结果试纸条会出现透明缺角"><span class="nav-number">11.11.</span> <span class="nav-text">输出抠图结果试纸条会出现透明缺角</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#试纸在复杂背景抠图结果可能不一致"><span class="nav-number">11.12.</span> <span class="nav-text">试纸在复杂背景抠图结果可能不一致</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#试纸logo类型未定义"><span class="nav-number">11.13.</span> <span class="nav-text">试纸logo类型未定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#替换或隐藏试纸结果确认框样例说明"><span class="nav-number">11.14.</span> <span class="nav-text">替换或隐藏试纸结果确认框样例说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#替换或隐藏power-by-shecare说明"><span class="nav-number">11.15.</span> <span class="nav-text">替换或隐藏power by shecare说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#APP添加信任"><span class="nav-number">11.16.</span> <span class="nav-text">APP添加信任</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">iKangtai</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
